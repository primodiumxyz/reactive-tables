var Fe=Object.create;var X=Object.defineProperty;var He=Object.getOwnPropertyDescriptor;var ve=Object.getOwnPropertyNames;var _e=Object.getPrototypeOf,De=Object.prototype.hasOwnProperty;var _=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var I=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var Pe=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of ve(r))!De.call(e,o)&&o!==t&&X(e,o,{get:()=>r[o],enumerable:!(n=He(r,o))||n.enumerable});return e};var $e=(e,r,t)=>(t=e!=null?Fe(_e(e)):{},Pe(r||!e||!e.__esModule?X(t,"default",{value:e,enumerable:!0}):t,e));var pe=I((Wr,ce)=>{"use strict";var B=1e3,w=B*60,R=w*60,S=R*24,ct=S*7,pt=S*365.25;ce.exports=function(e,r){r=r||{};var t=typeof e;if(t==="string"&&e.length>0)return yt(e);if(t==="number"&&isFinite(e))return r.long?dt(e):ut(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function yt(e){if(e=String(e),!(e.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*pt;case"weeks":case"week":case"w":return t*ct;case"days":case"day":case"d":return t*S;case"hours":case"hour":case"hrs":case"hr":case"h":return t*R;case"minutes":case"minute":case"mins":case"min":case"m":return t*w;case"seconds":case"second":case"secs":case"sec":case"s":return t*B;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function ut(e){var r=Math.abs(e);return r>=S?Math.round(e/S)+"d":r>=R?Math.round(e/R)+"h":r>=w?Math.round(e/w)+"m":r>=B?Math.round(e/B)+"s":e+"ms"}function dt(e){var r=Math.abs(e);return r>=S?E(e,r,S,"day"):r>=R?E(e,r,R,"hour"):r>=w?E(e,r,w,"minute"):r>=B?E(e,r,B,"second"):e+" ms"}function E(e,r,t,n){var o=r>=t*1.5;return Math.round(e/t)+" "+n+(o?"s":"")}});var K=I((Jr,ye)=>{"use strict";function lt(e){t.debug=t,t.default=t,t.coerce=d,t.disable=s,t.enable=o,t.enabled=i,t.humanize=pe(),t.destroy=u,Object.keys(e).forEach(a=>{t[a]=e[a]}),t.names=[],t.skips=[],t.formatters={};function r(a){let p=0;for(let l=0;l<a.length;l++)p=(p<<5)-p+a.charCodeAt(l),p|=0;return t.colors[Math.abs(p)%t.colors.length]}t.selectColor=r;function t(a){let p,l=null,F,Y;function h(...T){if(!h.enabled)return;let x=h,H=Number(new Date),Re=H-(p||H);x.diff=Re,x.prev=p,x.curr=H,p=H,T[0]=t.coerce(T[0]),typeof T[0]!="string"&&T.unshift("%O");let v=0;T[0]=T[0].replace(/%([a-zA-Z%])/g,(U,c)=>{if(U==="%%")return"%";v++;let Z=t.formatters[c];if(typeof Z=="function"){let Oe=T[v];U=Z.call(x,Oe),T.splice(v,1),v--}return U}),t.formatArgs.call(x,T),(x.log||t.log).apply(x,T)}return h.namespace=a,h.useColors=t.useColors(),h.color=t.selectColor(a),h.extend=n,h.destroy=t.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(F!==t.namespaces&&(F=t.namespaces,Y=t.enabled(a)),Y),set:T=>{l=T}}),typeof t.init=="function"&&t.init(h),h}function n(a,p){let l=t(this.namespace+(typeof p>"u"?":":p)+a);return l.log=this.log,l}function o(a){t.save(a),t.namespaces=a,t.names=[],t.skips=[];let p,l=(typeof a=="string"?a:"").split(/[\s,]+/),F=l.length;for(p=0;p<F;p++)l[p]&&(a=l[p].replace(/\*/g,".*?"),a[0]==="-"?t.skips.push(new RegExp("^"+a.slice(1)+"$")):t.names.push(new RegExp("^"+a+"$")))}function s(){let a=[...t.names.map(y),...t.skips.map(y).map(p=>"-"+p)].join(",");return t.enable(""),a}function i(a){if(a[a.length-1]==="*")return!0;let p,l;for(p=0,l=t.skips.length;p<l;p++)if(t.skips[p].test(a))return!1;for(p=0,l=t.names.length;p<l;p++)if(t.names[p].test(a))return!0;return!1}function y(a){return a.toString().substring(2,a.toString().length-2).replace(/\.\*\?$/,"*")}function d(a){return a instanceof Error?a.stack||a.message:a}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}ye.exports=lt});var ue=I((g,L)=>{"use strict";g.formatArgs=ft;g.save=gt;g.load=Tt;g.useColors=mt;g.storage=bt();g.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();g.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function mt(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function ft(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+L.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;e.splice(1,0,r,"color: inherit");let t=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),e.splice(n,0,r)}g.log=console.debug||console.log||(()=>{});function gt(e){try{e?g.storage.setItem("debug",e):g.storage.removeItem("debug")}catch{}}function Tt(){let e;try{e=g.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function bt(){try{return localStorage}catch{}}L.exports=K()(g);var{formatters:ht}=L.exports;ht.j=function(e){try{return JSON.stringify(e)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}});var le=I((Qr,de)=>{"use strict";de.exports=(e,r=process.argv)=>{let t=e.startsWith("-")?"":e.length===1?"-":"--",n=r.indexOf(t+e),o=r.indexOf("--");return n!==-1&&(o===-1||n<o)}});var ge=I((Yr,fe)=>{"use strict";var xt=_("os"),me=_("tty"),b=le(),{env:m}=process,k;b("no-color")||b("no-colors")||b("color=false")||b("color=never")?k=0:(b("color")||b("colors")||b("color=true")||b("color=always"))&&(k=1);function It(){if("FORCE_COLOR"in m)return m.FORCE_COLOR==="true"?1:m.FORCE_COLOR==="false"?0:m.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(m.FORCE_COLOR,10),3)}function At(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function Ct(e,{streamIsTTY:r,sniffFlags:t=!0}={}){let n=It();n!==void 0&&(k=n);let o=t?k:n;if(o===0)return 0;if(t){if(b("color=16m")||b("color=full")||b("color=truecolor"))return 3;if(b("color=256"))return 2}if(e&&!r&&o===void 0)return 0;let s=o||0;if(m.TERM==="dumb")return s;if(process.platform==="win32"){let i=xt.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in m)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(i=>i in m)||m.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in m)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(m.TEAMCITY_VERSION)?1:0;if(m.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in m){let i=Number.parseInt((m.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(m.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(m.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(m.TERM)||"COLORTERM"in m?1:s}function V(e,r={}){let t=Ct(e,{streamIsTTY:e&&e.isTTY,...r});return At(t)}fe.exports={supportsColor:V,stdout:V({isTTY:me.isatty(1)}),stderr:V({isTTY:me.isatty(2)})}});var be=I((f,M)=>{"use strict";var St=_("tty"),j=_("util");f.init=vt;f.log=Ot;f.formatArgs=wt;f.save=Ft;f.load=Ht;f.useColors=Bt;f.destroy=j.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");f.colors=[6,2,3,4,5,1];try{let e=ge();e&&(e.stderr||e).level>=2&&(f.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}f.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,r)=>{let t=r.substring(6).toLowerCase().replace(/_([a-z])/g,(o,s)=>s.toUpperCase()),n=process.env[r];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[t]=n,e},{});function Bt(){return"colors"in f.inspectOpts?!!f.inspectOpts.colors:St.isatty(process.stderr.fd)}function wt(e){let{namespace:r,useColors:t}=this;if(t){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${o};1m${r} \x1B[0m`;e[0]=s+e[0].split(`
`).join(`
`+s),e.push(o+"m+"+M.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=Rt()+r+" "+e[0]}function Rt(){return f.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Ot(...e){return process.stderr.write(j.format(...e)+`
`)}function Ft(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function Ht(){return process.env.DEBUG}function vt(e){e.inspectOpts={};let r=Object.keys(f.inspectOpts);for(let t=0;t<r.length;t++)e.inspectOpts[r[t]]=f.inspectOpts[r[t]]}M.exports=K()(f);var{formatters:Te}=M.exports;Te.o=function(e){return this.inspectOpts.colors=this.useColors,j.inspect(e,this.inspectOpts).split(`
`).map(r=>r.trim()).join(" ")};Te.O=function(e){return this.inspectOpts.colors=this.useColors,j.inspect(e,this.inspectOpts)}});var he=I((Zr,z)=>{"use strict";typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?z.exports=ue():z.exports=be()});var Ne=(c=>(c[c.Boolean=0]="Boolean",c[c.Number=1]="Number",c[c.OptionalNumber=2]="OptionalNumber",c[c.BigInt=3]="BigInt",c[c.OptionalBigInt=4]="OptionalBigInt",c[c.String=5]="String",c[c.OptionalString=6]="OptionalString",c[c.NumberArray=7]="NumberArray",c[c.OptionalNumberArray=8]="OptionalNumberArray",c[c.BigIntArray=9]="BigIntArray",c[c.OptionalBigIntArray=10]="OptionalBigIntArray",c[c.StringArray=11]="StringArray",c[c.OptionalStringArray=12]="OptionalStringArray",c[c.Hex=13]="Hex",c[c.OptionalHex=14]="OptionalHex",c[c.HexArray=15]="HexArray",c[c.OptionalHexArray=16]="OptionalHexArray",c[c.$Record=17]="$Record",c[c.Optional$Record=18]="Optional$Record",c[c.$RecordArray=19]="$RecordArray",c[c.Optional$RecordArray=20]="Optional$RecordArray",c[c.T=21]="T",c[c.OptionalT=22]="OptionalT",c))(Ne||{}),er={uint8:1,uint16:1,uint24:1,uint32:1,uint40:1,uint48:1,uint56:3,uint64:3,uint72:3,uint80:3,uint88:3,uint96:3,uint104:3,uint112:3,uint120:3,uint128:3,uint136:3,uint144:3,uint152:3,uint160:3,uint168:3,uint176:3,uint184:3,uint192:3,uint200:3,uint208:3,uint216:3,uint224:3,uint232:3,uint240:3,uint248:3,uint256:3,int8:1,int16:1,int24:1,int32:1,int40:1,int48:1,int56:3,int64:3,int72:3,int80:3,int88:3,int96:3,int104:3,int112:3,int120:3,int128:3,int136:3,int144:3,int152:3,int160:3,int168:3,int176:3,int184:3,int192:3,int200:3,int208:3,int216:3,int224:3,int232:3,int240:3,int248:3,int256:3,bytes1:13,bytes2:13,bytes3:13,bytes4:13,bytes5:13,bytes6:13,bytes7:13,bytes8:13,bytes9:13,bytes10:13,bytes11:13,bytes12:13,bytes13:13,bytes14:13,bytes15:13,bytes16:13,bytes17:13,bytes18:13,bytes19:13,bytes20:13,bytes21:13,bytes22:13,bytes23:13,bytes24:13,bytes25:13,bytes26:13,bytes27:13,bytes28:13,bytes29:13,bytes30:13,bytes31:13,bytes32:13,bool:0,address:13,"uint8[]":7,"uint16[]":7,"uint24[]":7,"uint32[]":7,"uint40[]":7,"uint48[]":7,"uint56[]":9,"uint64[]":9,"uint72[]":9,"uint80[]":9,"uint88[]":9,"uint96[]":9,"uint104[]":9,"uint112[]":9,"uint120[]":9,"uint128[]":9,"uint136[]":9,"uint144[]":9,"uint152[]":9,"uint160[]":9,"uint168[]":9,"uint176[]":9,"uint184[]":9,"uint192[]":9,"uint200[]":9,"uint208[]":9,"uint216[]":9,"uint224[]":9,"uint232[]":9,"uint240[]":9,"uint248[]":9,"uint256[]":9,"int8[]":7,"int16[]":7,"int24[]":7,"int32[]":7,"int40[]":7,"int48[]":7,"int56[]":9,"int64[]":9,"int72[]":9,"int80[]":9,"int88[]":9,"int96[]":9,"int104[]":9,"int112[]":9,"int120[]":9,"int128[]":9,"int136[]":9,"int144[]":9,"int152[]":9,"int160[]":9,"int168[]":9,"int176[]":9,"int184[]":9,"int192[]":9,"int200[]":9,"int208[]":9,"int216[]":9,"int224[]":9,"int232[]":9,"int240[]":9,"int248[]":9,"int256[]":9,"bytes1[]":15,"bytes2[]":15,"bytes3[]":15,"bytes4[]":15,"bytes5[]":15,"bytes6[]":15,"bytes7[]":15,"bytes8[]":15,"bytes9[]":15,"bytes10[]":15,"bytes11[]":15,"bytes12[]":15,"bytes13[]":15,"bytes14[]":15,"bytes15[]":15,"bytes16[]":15,"bytes17[]":15,"bytes18[]":15,"bytes19[]":15,"bytes20[]":15,"bytes21[]":15,"bytes22[]":15,"bytes23[]":15,"bytes24[]":15,"bytes25[]":15,"bytes26[]":15,"bytes27[]":15,"bytes28[]":15,"bytes29[]":15,"bytes30[]":15,"bytes31[]":15,"bytes32[]":15,"bool[]":21,"address[]":15,bytes:13,string:5};var rr=function(){let e=Ee,r=Le;return r(e(32),8)+"-"+r(e(16),4)+"-"+r(16384|e(12),4)+"-"+r(32768|e(14),4)+"-"+r(e(48),12)},Ee=function(e){if(e<0||e>53)return NaN;let r=0|Math.random()*1073741824;return e>30?r+(0|Math.random()*(1<<e-30))*1073741824:r>>>30-e},Le=function(e,r){let t=e.toString(16),n=r-t.length,o="0";for(;n>0;n>>>=1,o+=o)n&1&&(t=o+t);return t};var or=(e,r,t)=>{e.setTable(`table__${r}`,{propertiesSchema:t})},ee=(e,r)=>{let t=e.getRow(`table__${r}`,"propertiesSchema");if(Object.keys(t).length===0)throw new Error(`Table with id ${r} is empty`);return t};var O=["__staticData","__encodedLengths","__dynamicData"],D=["__lastSyncedAtBlock"];import{concatHex as ke,decodeAbiParameters as je,encodeAbiParameters as Me,isHex as Ue,size as Ke,sliceHex as Ve}from"viem";var cr=P([]);function P(e){return ke(e)}function ze(e){if(!Ue(e))throw new Error(`$record ${e} is not a hex string`);let r=Ke(e);if(r%32!==0)throw new Error(`$record length ${r} is not a multiple of 32 bytes`);return new Array(r/32).fill(0).map((t,n)=>Ve(e,n*32,(n+1)*32))}var pr=(e,r)=>{if(Object.keys(e).length!==Object.keys(r).length)throw new Error(`$record length ${Object.keys(r).length} does not match $record schema length ${Object.keys(e).length}`);return P(Object.entries(e).map(([t,n])=>Me([{type:n}],[r[t]])))},yr=(e,r)=>{let t=ze(r);if(t.length!==Object.keys(e).length)throw new Error(`$record $record tuple length ${t.length} does not match $record schema length ${Object.keys(e).length}`);return Object.fromEntries(Object.entries(e).map(([n,o],s)=>[n,je([{type:o}],t[s])[0]]))},ur=e=>{let r=0;return{...{next(){return r>=e.length?{done:!0,value:void 0}:{done:!1,value:e[r++]}}},[Symbol.iterator](){return this}}};function lr(e,r){let t={};for(let n in e)t[n]=r(e[n],n);return t}var fr=(e,r)=>({paused:{set:(n,o)=>{e.setValue(`paused__${r}__${n}`,o)},get:n=>e.getValue(`paused__${r}__${n}`)}});import{hexToResource as qe,spliceHex as te}from"@latticexyz/common";import{size as Ge}from"viem";import{Write as We}from"@primodiumxyz/sync-stack";var Je=({store:e})=>{let r=e(),t=n=>{let{namespace:o,name:s}=qe(n.args.tableId),i=P(n.args.keyTuple);if(!r.hasTable(`table__${n.args.tableId}`)){A(`unknown table: ${n.args.tableId} (${o}:${s})`);return}let d={id:n.args.tableId,namespace:o,name:s,propertiesSchema:ee(r,n.args.tableId)};return{$record:i,table:d}};return We.toCustom({set:n=>{let o=t(n);if(!o)return;let{$record:s,table:i}=o,y=C.decodeArgs(i.propertiesSchema,n.args);A("setting properties",{namespace:i.namespace,name:i.name,$record:s,properties:y}),r.setRow(i.id,s,{...y,__staticData:n.args.staticData,__encodedLengths:n.args.encodedLengths,__dynamicData:n.args.dynamicData,__lastSyncedAtBlock:n.blockNumber?.toString()??"unknown"})},updateStatic:n=>{let o=t(n);if(!o)return;let{$record:s,table:i}=o,y=r.getRow(i.id,s),d=y?.__staticData??"0x",u=te(d,n.args.start,Ge(n.args.data),n.args.data),a=C.decodeArgs(i.propertiesSchema,{staticData:u,encodedLengths:y?.__encodedLengths??"0x",dynamicData:y?.__dynamicData??"0x"});A("setting properties via splice static",{namespace:i.namespace,name:i.name,$record:s,previousStaticData:d,newStaticData:u,previousProperties:y,newProperties:a}),r.setRow(i.id,s,{...y,...a,__staticData:u,__lastSyncedAtBlock:n.blockNumber?.toString()??"unknown"})},updateDynamic:n=>{let o=t(n);if(!o)return;let{$record:s,table:i}=o,y=r.getRow(i.id,s),d=y?.__dynamicData??"0x",u=te(d,n.args.start,n.args.deleteCount,n.args.data),a=C.decodeArgs(i.propertiesSchema,{staticData:y?.__staticData??"0x",encodedLengths:n.args.encodedLengths,dynamicData:u});A("setting properties via splice dynamic",{namespace:i.namespace,name:i.name,$record:s,previousDynamicData:d,newDynamicData:u,previousProperties:y,newProperties:a}),r.setRow(i.id,s,{...a,__encodedLengths:n.args.encodedLengths,__dynamicData:u,__lastSyncedAtBlock:n.blockNumber?.toString()??"unknown"})},delete:n=>{let o=t(n);if(!o)return;let{$record:s,table:i}=o;A("deleting properties",{namespace:i.namespace,name:i.name,$record:s}),r.delRow(i.id,s)}})};import{concatHex as Qe}from"viem";import{isDynamicAbiType as Ye,isStaticAbiType as re}from"@latticexyz/schema-type/internal";import{decodeDynamicField as Ze,decodeStaticField as Xe,hexToEncodedLengths as et,staticDataLength as ne}from"@latticexyz/protocol-parser/internal";import{readHex as N}from"@latticexyz/common";import{staticAbiTypeToByteLength as tt,dynamicAbiTypeToDefaultValue as rt}from"@latticexyz/schema-type/internal";var $=e=>{let r={};return Object.entries(e).forEach(([t,n])=>{let o=Array.isArray(n)?`${typeof n[0]}[]`:typeof n;r[t]=Array.isArray(n)?JSON.stringify(n,(s,i)=>typeof i=="bigint"?i.toString():i):typeof n=="bigint"?n.toString():n,r[`type__${t}`]=o}),r};function oe(e,r){let{staticData:t,encodedLengths:n,dynamicData:o}=r;return nt(e,Qe([N(t,0,ne(Object.values(e).filter(re))),n,o]))}function nt(e,r){let t=Object.values(e).filter(re),n=Object.values(e).filter(Ye),o=ot({staticFields:t,dynamicFields:n},r);return $(Object.fromEntries(Object.keys(e).map((s,i)=>[s,o[i]])))}function ot(e,r){let t=[],n=0;e.staticFields.forEach(i=>{let y=tt[i],d=Xe(i,N(r,n,n+y));n+=y,t.push(d)});let o=ne(e.staticFields),s=n;if(s!==o&&console.warn("Decoded static data length does not match value schema's expected static data length. Data may get corrupted. Is `getStaticByteLength` outdated?",{expectedLength:o,actualLength:s,bytesOffset:n}),e.dynamicFields.length>0){let i=et(N(r,n,n+32));n+=32,e.dynamicFields.forEach((d,u)=>{let a=i.fieldByteLengths[u];if(a>0){let p=Ze(d,N(r,n,n+a));n+=a,t.push(p)}else t.push(rt[d])});let y=n-32-s;BigInt(y)!==i.totalByteLength&&console.warn("Decoded dynamic data length does not match data layout's expected data length. Data may get corrupted. Did the data layout change?",{expectedLength:i.totalByteLength,actualLength:y,bytesOffset:n})}return t}var st=e=>O.concat(D).includes(e)||e.startsWith("type__"),se=e=>{if(Object.keys(e).length===0)return;let r={};return Object.entries(e).forEach(([t,n])=>{if(!st(t)){let s=e[`type__${t}`];if(!s)throw new Error(`Type information missing for key: ${t}`);s==="bigint"?r[t]=BigInt(n):s==="number"||s==="boolean"||s==="string"?r[t]=n:s==="bigint[]"?r[t]=JSON.parse(n).map(BigInt):s==="number[]"?r[t]=JSON.parse(n).map(Number):s==="boolean[]"?r[t]=JSON.parse(n).map(i=>i==="true"):s==="string[]"?r[t]=JSON.parse(n):s==="undefined[]"?r[t]=JSON.parse(n).map(()=>{}):s==="undefined"&&(r[t]=void 0)}O.forEach(s=>{r[s]=e[s]});let o=e.__lastSyncedAtBlock;r.__lastSyncedAtBlock=o&&o!=="unknown"?BigInt(o):void 0}),r};var C={decodeArgs:oe,decode:se,encode:$};var Mr=(e,r,t,n)=>{let o="change";r=r.map(u=>O.includes(u)?u:[u,`type__${u}`]).flat().concat(D);let{current:s,prev:i}=r.reduce((u,a)=>{let[,p,l]=e(t,n,a);return u.current[a]=l,u.prev[a]=p,u},{current:{},prev:{}});Object.values(s).every(u=>u===void 0)?o="exit":Object.values(i).every(u=>u===void 0)&&(o="enter");let y=o==="exit"?void 0:C.decode(s),d=o==="enter"?void 0:C.decode(i);return{tableId:t,$record:n,properties:{current:y,prev:d},type:o}};import{createStore as ie}from"tinybase/store";import{createQueries as ae}from"tinybase/queries";import{createLocalPersister as it}from"tinybase/persisters/persister-browser";var at="TINYBASE_STATE_MANAGER_PERSISTER",qr=()=>{let e=ie(),r=ae(e),t=typeof window<"u",n=()=>{if(!t)throw new Error("Persistent store is only available on the browser");let s=ie(),i=ae(s),y=it(s,at,d=>{console.warn("Error persisting state, some settings might no be saved correctly"),console.error(d)});return(async()=>(s.setValue("ready",!1),await y.startAutoLoad(),await y.startAutoSave(),s.setValue("ready",!0)))(),{...s,getQueries:()=>i,dispose:()=>y.destroy(),ready:new Promise(d=>{s.getValue("ready")&&d(!0);let u=s.addValueListener("ready",(a,p,l)=>{l&&(s.delListener(u),d(!0))})})}};function o(s){return s==="PERSIST"?n():{...e,getQueries:()=>r}}return o};var q=$e(he(),1),A=(0,q.default)("primodium:reactive-tables"),_t=(0,q.default)("primodium:reactive-tables");A.log=console.debug.bind(console);_t.log=console.error.bind(console);import{resolveConfig as Be}from"@latticexyz/store/config";import{storeToV1 as we}from"@latticexyz/store/config/v2";import Yt from"@latticexyz/store/mud.config";var xe={registerFunctionSelector:!0,openAccess:!0,accessList:[]};import{extendedScope as Ce,get as Dt,resolveTable as Pt,validateTable as $t,mergeIfUndefined as G,validateTables as Nt,resolveStore as Et,hasOwnKey as Ie,validateStore as Lt,isObject as kt}from"@latticexyz/store/config/v2";import{mapObject as jt}from"@latticexyz/common/utils";import{mergeIfUndefined as Mt}from"@latticexyz/store/config/v2";import{isObject as Kt,mergeIfUndefined as Vt}from"@latticexyz/store/config/v2";import{mergeIfUndefined as qt,isObject as Gt}from"@latticexyz/store/config/v2";var W={worldInterfaceName:"IWorld",worldgenDirectory:"world",worldImportPath:"@latticexyz/world/src/"},J={customWorldContract:void 0,postDeployScript:"PostDeploy",deploysDirectory:"./deploys",worldsFile:"./worlds.json"},Ae={systems:{},tables:{},excludeSystems:[],modules:[],codegen:W,deploy:J};function Ut(e){return jt(e,r=>Mt(r,xe))}function zt(e){return Kt(e)?Vt(e,W):W}function Wt(e){return Gt(e)?qt(e,J):J}function Jt(e){let r=Ce(e);if(Lt(e),Ie(e,"namespaces")){if(!kt(e.namespaces))throw new Error(`Expected namespaces, received ${JSON.stringify(e.namespaces)}`);for(let t of Object.values(e.namespaces))Ie(t,"tables")&&Nt(t.tables,r)}}function Qt(e){let r=Ce(e),t=e.namespaces??{},n=Object.fromEntries(Object.entries(t).map(([s,i])=>Object.entries(i.tables??{}).map(([y,d])=>($t(d,r),[`${s}__${y}`,Pt(G(d,{namespace:s,name:y}),r)]))).flat()),o=Et(e);return G({...o,tables:{...o.tables,...n},codegen:G(o.codegen,zt(e.codegen)),deploy:Wt(e.deploy),systems:Ut(e.systems??Ae.systems),excludeSystems:Dt(e,"excludeSystems"),modules:e.modules},Ae)}function Se(e){return Jt(e),Qt(e)}var Q=Se({codegen:{worldImportPath:"../../",worldgenDirectory:"interfaces",worldInterfaceName:"IBaseWorld"},namespace:"world",userTypes:{ResourceId:{filePath:"@latticexyz/store/src/ResourceId.sol",type:"bytes32"}},tables:{NamespaceOwner:{schema:{namespaceId:"ResourceId",owner:"address"},key:["namespaceId"]},ResourceAccess:{schema:{resourceId:"ResourceId",caller:"address",access:"bool"},key:["resourceId","caller"]},InstalledModules:{schema:{moduleAddress:"address",argumentsHash:"bytes32",isInstalled:"bool"},key:["moduleAddress","argumentsHash"]},UserDelegationControl:{schema:{delegator:"address",delegatee:"address",delegationControlId:"ResourceId"},key:["delegator","delegatee"]},NamespaceDelegationControl:{schema:{namespaceId:"ResourceId",delegationControlId:"ResourceId"},key:["namespaceId"]},Balances:{schema:{namespaceId:"ResourceId",balance:"uint256"},key:["namespaceId"]},Systems:{schema:{systemId:"ResourceId",system:"address",publicAccess:"bool"},key:["systemId"],codegen:{dataStruct:!1}},SystemRegistry:{schema:{system:"address",systemId:"ResourceId"},key:["system"]},SystemHooks:{schema:{systemId:"ResourceId",value:"bytes21[]"},key:["systemId"]},FunctionSelectors:{schema:{worldFunctionSelector:"bytes4",systemId:"ResourceId",systemFunctionSelector:"bytes4"},key:["worldFunctionSelector"],codegen:{dataStruct:!1}},FunctionSignatures:{type:"offchainTable",schema:{functionSelector:"bytes4",functionSignature:"string"},key:["functionSelector"]},InitModuleAddress:{schema:{value:"address"},key:[]}},excludeSystems:["StoreRegistrationSystem"]});var hn=Be(we(Yt)).tables,xn=Be(we(Q)).tables;export{Ne as a,er as b,lr as c,rr as d,or as e,ee as f,fr as g,Mr as h,qr as i,O as j,D as k,hn as l,xn as m,cr as n,P as o,ze as p,pr as q,yr as r,ur as s,Je as t,C as u};
/**
 * UUID.core.js - UUID.js for Minimalists
 *
 * @file
 * @author  LiosK
 * @version v4.2.0
 * @license Apache License 2.0: Copyright (c) 2010-2018 LiosK
 * @url https://github.com/LiosK/UUID.js/blob/master/src/uuid.core.js
 */
//# sourceMappingURL=chunk-Q2PQUU6M.js.map